{% extends 'base.html' %}
{% load static %}
{% block extra_css %}
<link rel="stylesheet" href="{% static 'menu/css/menu.css' %}">
{% endblock %}
{% block extra_js %}
<script type="text/javascript" src="{% static 'menu/js/menu.js' %}"></script
{% endblock %}

{% block content %}
<a href="{% url 'view_cart' %}">View cart</a>
<section id="pizza-section">
    <h1 class="menu-section-heading">Pizzas</h1>
    <div class="row no-gutters product-list">
        {% for pizza in pizzas %}
        <div class="col-12 col-md-6 col-lg-4 col-xl-3 menu-item-wrapper">
            <div class="menu-item">
                <div class="menu-item-details">
                    <img src="{{pizza.0.image_url}}">
                    <span>{{ pizza.0.name }}</span>
                </div>
                <div class="menu-item-options">    
                    <form class="form" action="{% url 'add_to_cart' pizza.0.sku %}" method="POST">
                    {% csrf_token %}                                        
                        <select name="size_price">
                            <option value='{ "size": "small", "price":"{{pizza.0.small_price}}" }'>Small {{pizza.0.small_price}}</option>
                            <option value='{ "size": "medium", "price":"{{pizza.0.medium_price}}" }'>Medium {{pizza.0.medium_price}}</option>
                            <option value='{ "size": "large", "price":"{{pizza.0.large_price}}" }'>Large {{pizza.0.large_price}}</option>
                        </select>
                        <input type="hidden"  name="product_type" value={{pizza.0.product_type}}>
                        <input type="hidden"  name="quantity" value="1">
                        <input type="submit" class="item-submit" value="Add">   
                    </form>
                </div>
            </div>    
            <!--div class="pizza-toppings">
                <ul>
                {% for topping in pizza.1 %}
                    <li>{{ topping.1 }} {{ topping.0 }}</li> 
                {% endfor %}
                </ul>
            </div-->
        </div> 
        {% endfor %}
    </div>        
</section>
<section id="side-section">
    <h1 class="menu-section-heading">Sides</h1>
    <div class="row no-gutters product-list">
        {% for side in sides %}
        <div class="col-12 col-md-6 col-lg-4 col-xl-3 menu-item-wrapper">
            <div class="menu-item">
                <div class="menu-item-details">
                    <img src="{{side.product.image_url}}">
                    <span>{{ side.product.name }}</span>
                </div>
                <div class="menu-item-options">    
                    <form class="form" action="{% url 'add_to_cart' side.product.sku %}" method="POST">
                    {% csrf_token %}
                    {% if side.sizes|length == 1%}
                        <input type="hidden" value='{ "size": "{{side.sizes.0.size}}", "price":"{{side.sizes.0.price}}" }' name="size_price">
                        <span>{{side.sizes.0.price}}</span>
                    {% else %}
                        <select name="size_price">
                        {% for size in side.sizes %}
                            <option value='{ "size": "{{size.size}}", "price":"{{size.price}}" }'>Medium {{size.price}}</option>
                        {% endfor %}
                        </select>
                    {% endif %}
                        <div class="qty-wrapper">                                            
                            <select class="select-qty" name="quantity">
                                <option value="1">1</option>
                                <option value="2">2</option>
                                <option value="3">3</option>
                            </select>                        
                            <input type="submit" class="item-submit" value="ADD TO CART">
                        </div>
                        <input type="hidden"  name="product_type" value={{side.product_type}}>   
                    </form>
                </div>
            </div>    
        </div> 
        {% endfor %}
    </div>        
</section>
<section id="dessert-section">
    <h1 class="menu-section-heading">Desserts</h1>
    <div class="row no-gutters product-list">
        {% for dessert in desserts %}
        <form class="form" action="{% url 'add_to_cart' dessert.sku %}" method="POST">
        {% csrf_token %}
            <div class="menu-item">
                <span>{{ dessert.name }}</span>
            </div>
            <select name="size_price">
                <option value='{ "size": "medium", "price":"{{dessert.regular_price}}" }'>Regular {{dessert.regular_price}}</option>
                <option value='{ "size": "large", "price":"{{dessert.large_price}}" }'>Large {{dessert.large_price}}</option>
            </select>
                <select name="quantity">
                <option value="1">1</option>
                <option value="2">2</option>
                <option value="3">3</option>
            </select>
            <input type="hidden"  name="product_type" value={{dessert.product_type}}>
        <input type="submit" class="item-submit" value="Add">   
        </form>
        {% endfor %}
    </div>
</section>
<section id="drink-section">
    <h1 class="menu-section-heading">Drinks</h1>
    <div class="row no-gutters product-list">
        {% for drink in drink %}
        <form class="form" action="{% url 'add_to_cart' drink.sku %}" method="POST">
        {% csrf_token %}
            <div class="menu-item">
                <span>{{ drink.name }}</span>
            </div>
            <select name="size_price">
                <option value='{ "size": "medium", "price":"{{drink.regular_price}}" }'>Regular {{dessert.regular_price}}</option>
            </select>
            <select name="quantity">
                <option value="1">1</option>
                <option value="2">2</option>
                <option value="3">3</option>
            </select>
            <input type="hidden"  name="product_type" value={{drink.product_type}}>
        <input type="submit" class="item-submit" value="Add">   
        </form>
        {% endfor %}
    </div>
</section>
<a href="{% url 'flush_session' %}">Flush session</a>
{% endblock %}

